<main>
  <header>
    <h1>Simple Grid Demo</h1>
    <p class="instructions">
      <strong>Drag &amp; Drop:</strong> Drag column headers to reorder columns. Use Shift + Arrow
      keys for keyboard reordering.<br />
      <strong>Resize:</strong> Drag the resize handle on the right edge of each header, or use Tab
      to focus and arrow keys to resize.
    </p>
  </header>

  <div class="status">
    @if (dataSource.loading$ | async) {
      <span>Loading...</span>
    }
  </div>

  <sg-table-scroll
    [dataSource]="dataSource"
    [trackBy]="trackById"
    [batchSize]="50"
    [maxRenderItemCount]="100"
    [loadThresholdPercentBottom]="40"
    [loadThresholdPercentTop]="40"
    (loadingState)="onLoadingStateChange($event)"
  >
    <table
      class="table"
      sg-table
      fixedLayout
      [dnd]="true"
      [resizable]="true"
      (updateColumnOrder)="onUpdateColumnOrder($event)"
      (updateColumnWidth)="onUpdateColumnWidth($event)"
    >
      <!-- ID Column - width constraints specified directly on header cell -->
      <ng-container sgColumnDef="id">
        <th sg-header-cell *sgHeaderCellDef [width]="100" [minWidth]="60" [maxWidth]="200">ID</th>
        <td sg-cell *sgCellDef="let user">{{ user.id }}</td>
      </ng-container>

      <!-- Name Column -->
      <ng-container sgColumnDef="name">
        <th sg-header-cell *sgHeaderCellDef [width]="200" [minWidth]="100" [maxWidth]="400">
          Name
        </th>
        <td sg-cell *sgCellDef="let user">{{ user.name }}</td>
      </ng-container>

      <!-- Email Column -->
      <ng-container sgColumnDef="email">
        <th sg-header-cell *sgHeaderCellDef [width]="300" [minWidth]="150" [maxWidth]="500">
          Email
        </th>
        <td sg-cell *sgCellDef="let user">{{ user.email }}</td>
      </ng-container>

      <!-- Header and Row Declarations -->
      <tr sg-header-row *sgHeaderRowDef="displayedColumns; sticky: true"></tr>
      <tr sg-row *sgRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </sg-table-scroll>
</main>
